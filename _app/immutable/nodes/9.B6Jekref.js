import"../chunks/DsnmJJEf.js";import"../chunks/C3jkjRJ1.js";import{o as le}from"../chunks/DsMb63vb.js";import{av as oe,ax as h,a as d,aw as ie,s as r,K as p,az as a,b as s,aA as t,ay as l,aC as D,aF as re}from"../chunks/CdeIWoL4.js";import{s as F,e as f}from"../chunks/CUaUiNLG.js";import{i as P}from"../chunks/B1etJHai.js";import{A as S,r as J,s as z}from"../chunks/o3SDYzGp.js";import{b as N}from"../chunks/9QlUfJ6K.js";import{i as ne}from"../chunks/l0-HXMSf.js";import{b as T}from"../chunks/DocwxD49.js";var ve=h('<div class="backend-loading svelte-iv8lg3"><h2 class="svelte-iv8lg3">Conectando con el servidor...</h2> <p class="svelte-iv8lg3">Estamos estableciendo una conexión segura. Esto puede tardar unos instantes.</p></div>'),ce=h('<p class="err svelte-iv8lg3"> </p>'),de=h('<span class="loading svelte-iv8lg3"><span class="dot svelte-iv8lg3"></span><span class="dot svelte-iv8lg3"></span><span class="dot svelte-iv8lg3"></span> Entrando…</span>'),pe=h('<section class="auth svelte-iv8lg3" role="form" aria-labelledby="title-login"><div class="head svelte-iv8lg3"><h1 id="title-login" class="svelte-iv8lg3">Acceso</h1></div> <div class="body svelte-iv8lg3"><p class="subtitle access-instructions svelte-iv8lg3"><strong class="svelte-iv8lg3">¿Primera vez en KitIA?</strong> <br class="svelte-iv8lg3"/> Ingresa tu email y crea una contraseña, luego haz clic en <strong class="svelte-iv8lg3">Crear cuenta</strong>.</p> <p class="subtitle access-instructions svelte-iv8lg3"><strong class="svelte-iv8lg3">¿Ya tienes cuenta?</strong> <br class="svelte-iv8lg3"/> Ingresa tus datos y haz clic en <strong class="svelte-iv8lg3">Entrar</strong>.</p> <div class="inputRow svelte-iv8lg3"><label for="email" class="svelte-iv8lg3">Email</label> <div class="inputWrap svelte-iv8lg3"><input id="email" class="input svelte-iv8lg3" type="email" placeholder="tu@correo.com" autocomplete="email"/></div></div> <div class="inputRow svelte-iv8lg3"><label for="pass" class="svelte-iv8lg3">Contraseña</label> <div class="inputWrap svelte-iv8lg3"><input id="pass" class="input svelte-iv8lg3" placeholder="••••••••" autocomplete="current-password"/> <button type="button" class="toggle svelte-iv8lg3" aria-label="Mostrar u ocultar contraseña"> </button></div></div> <!> <div class="actions svelte-iv8lg3"><button class="btn primary svelte-iv8lg3"><!></button> <button class="btn svelte-iv8lg3" aria-label="Crear cuenta nueva">Crear cuenta</button></div></div> <div class="foot svelte-iv8lg3"><span class="help svelte-iv8lg3">¿Olvidaste tu contraseña? <a class="link svelte-iv8lg3">Recupérala</a></span> <span class="help svelte-iv8lg3">¿Problemas? <a class="link svelte-iv8lg3">Contáctanos</a></span></div></section>'),ge=h('<div class="page svelte-iv8lg3"><!></div>');function xe(Y,q){oe(q,!1);let _=p(""),w=p(""),y=p(""),g=p(!1),k=p(!1),u=p(!1);le(()=>{(async()=>{try{if((await fetch(`${S}/health`)).ok)r(u,!0),console.log("Conectado al servidor");else throw new Error("Backend not ready")}catch{console.log("Backend no disponible")}})();const n=setInterval(async()=>{try{(await fetch(`${S}/health`)).ok?(r(u,!0),console.log("Conectado al servidor")):(r(u,!1),console.log("Backend no disponible"))}catch{r(u,!1),console.log("Backend no disponible")}},3e4);return()=>clearInterval(n)});async function E(o){r(g,!0),r(y,"");try{const i=await fetch(`${S}/auth/${o}`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({email:s(_),password:s(w)}),credentials:"include",mode:"cors"});if(!i.ok)throw new Error(await i.text()||"Error");const n=await i.json();localStorage.setItem("access_token",n.access_token),localStorage.setItem("email",s(_)),window.location.href=`${T}/app/`}catch(i){r(y,i.message)}finally{r(g,!1)}}const O=o=>{o.key==="Enter"&&(o.preventDefault(),E("login"))};ne();var x=ge(),G=a(x);{var L=o=>{var i=ve();d(o,i)},Q=o=>{var i=pe(),n=l(a(i),2),v=l(a(n),4),R=l(a(v),2),C=a(R);J(C),t(R),t(v);var I=l(v,2),K=l(a(I),2),m=a(K);J(m);var A=l(m,2),U=a(A,!0);t(A),t(K),t(I);var M=l(I,2);{var V=e=>{var c=ce(),te=a(c,!0);t(c),D(()=>F(te,s(y))),d(e,c)};P(M,e=>{s(y)&&e(V)})}var $=l(M,2),b=a($),X=a(b);{var Z=e=>{var c=de();d(e,c)},ee=e=>{var c=re("Entrar");d(e,c)};P(X,e=>{s(g)?e(Z):e(ee,!1)})}t(b);var j=l(b,2);t($),t(n);var H=l(n,2),B=a(H),ae=l(a(B));t(B);var W=l(B,2),se=l(a(W));z(se,"href","mailto:kitia.app@gmail.com"),t(W),t(H),t(i),D(()=>{z(m,"type",s(k)?"text":"password"),F(U,s(k)?"Ocultar":"Mostrar"),b.disabled=s(g),j.disabled=s(g),z(ae,"href",`${T}/recuperar`)}),N(C,()=>s(_),e=>r(_,e)),f("keydown",C,O),N(m,()=>s(w),e=>r(w,e)),f("keydown",m,O),f("click",A,()=>r(k,!s(k))),f("click",b,()=>E("login")),f("click",j,()=>E("register")),d(o,i)};P(G,o=>{s(u)?o(Q,!1):o(L)})}t(x),d(Y,x),ie()}export{xe as component};
