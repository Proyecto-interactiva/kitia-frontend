import"../chunks/DsnmJJEf.js";import"../chunks/D_JxtCvG.js";import{aE as Y,aF as Z,aG as aa,aH as z,a as g,aI as ea,s as t,O as i,aK as s,aJ as o,b as a,aL as r,f as S,aM as A}from"../chunks/H9qgBCyD.js";import{s as $}from"../chunks/DflrDu60.js";import{i as C}from"../chunks/CoHz1Npk.js";import{s as E,r as J}from"../chunks/CsChzsNn.js";import{e as R}from"../chunks/CV5asq_h.js";import{b as T}from"../chunks/DicIaQeK.js";import{i as ta}from"../chunks/CQ-KNpQv.js";import{s as sa,a as ra}from"../chunks/WMH0LpM1.js";import{A as oa}from"../chunks/gz7YWXWY.js";import{b as la}from"../chunks/D73iepPs.js";import{p as ia}from"../chunks/CGGc3lc4.js";var na=z('<div class="ok svelte-156lzfn">¡Listo! Tu contraseña fue actualizada.</div> <div style="display:flex; gap:8px; margin-top:10px;"><a class="pill svelte-156lzfn">Ir a Acceso</a></div>',1),ca=z('<div class="err svelte-156lzfn"> </div>'),pa=z('<div class="inputRow"><label for="p1" class="svelte-156lzfn">Contraseña</label> <div class="inputWrap svelte-156lzfn"><input id="p1" class="input svelte-156lzfn" placeholder="••••••••" autocomplete="new-password"/> <button type="button" class="toggle svelte-156lzfn"> </button></div></div> <div class="inputRow"><label for="p2" class="svelte-156lzfn">Confirmar contraseña</label> <input id="p2" class="input svelte-156lzfn" placeholder="••••••••" autocomplete="new-password"/></div> <!> <button class="btn svelte-156lzfn"> </button>',1),va=z('<div class="page svelte-156lzfn"><section class="card svelte-156lzfn" role="form" aria-labelledby="reset-title"><div class="head svelte-156lzfn"><h1 id="reset-title" class="svelte-156lzfn">Nueva contraseña</h1> <span class="pill svelte-156lzfn">Paso 2 de 2</span></div> <div class="body svelte-156lzfn"><!></div></section></div>');function Aa(j,B){Y(B,!1);const O=()=>ra(ia,"$page",F),[F,G]=sa(),I=i();let n=i(""),d=i(""),v=i(!1),u=i(!1),c=i(""),L=i(!1);const H=e=>e.length>=8;async function K(){if(t(c,""),!H(a(n))){t(c,"Mínimo 8 caracteres.");return}if(a(n)!==a(d)){t(c,"Las contraseñas no coinciden.");return}t(u,!0);try{const e=await fetch(`${oa}/auth/password/reset`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({token:a(I),password:a(n)}),credentials:"include",mode:"cors"});if(!e.ok)throw new Error(await e.text()||"Error");t(L,!0)}catch(e){t(c,e.message||"No se pudo actualizar la contraseña.")}finally{t(u,!1)}}Z(()=>O(),()=>{t(I,O().params.token)}),aa(),ta();var h=va(),M=s(h),N=o(s(M),2),W=s(N);{var q=e=>{var f=na(),p=o(S(f),2),m=s(p);r(p),A(()=>E(m,"href",`${la}/login`)),g(e,f)},D=e=>{var f=pa(),p=S(f),m=o(s(p),2),_=s(m);J(_);var w=o(_,2),Q=s(w,!0);r(w),r(m),r(p);var y=o(p,2),x=o(s(y),2);J(x),r(y);var P=o(y,2);{var U=l=>{var k=ca(),X=s(k,!0);r(k),A(()=>$(X,a(c))),g(l,k)};C(P,l=>{a(c)&&l(U)})}var b=o(P,2),V=s(b,!0);r(b),A(()=>{E(_,"type",a(v)?"text":"password"),$(Q,a(v)?"Ocultar":"Mostrar"),E(x,"type",a(v)?"text":"password"),b.disabled=a(u)||!a(n)||!a(d),$(V,a(u)?"Actualizando…":"Actualizar contraseña")}),T(_,()=>a(n),l=>t(n,l)),R("click",w,()=>t(v,!a(v))),T(x,()=>a(d),l=>t(d,l)),R("click",b,K),g(e,f)};C(W,e=>{a(L)?e(q):e(D,!1)})}r(N),r(M),r(h),g(j,h),ea(),G()}export{Aa as component};
