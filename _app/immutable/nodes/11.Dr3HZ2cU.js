import"../chunks/DsnmJJEf.js";import"../chunks/uehYZzkF.js";import{av as Y,aw as Z,ax as aa,ay as z,a as g,az as ea,s as t,O as i,aB as s,aA as l,b as a,aC as r,f as I,aD as A}from"../chunks/oOC6CyD3.js";import{s as $,e as L}from"../chunks/Bj18uxIO.js";import{i as M}from"../chunks/C2ciDzbX.js";import{s as E,r as R,A as ta}from"../chunks/CdqO7dcH.js";import{b as T}from"../chunks/BqAu88Dq.js";import{i as sa}from"../chunks/BBFBmJEc.js";import{s as ra,a as la}from"../chunks/B43ZDVyP.js";import{b as oa}from"../chunks/C9vofX5_.js";import{p as ia}from"../chunks/DOkdyQX2.js";var na=z('<div class="ok svelte-156lzfn">¡Listo! Tu contraseña fue actualizada.</div> <div style="display:flex; gap:8px; margin-top:10px;"><a class="pill svelte-156lzfn">Ir a Acceso</a></div>',1),ca=z('<div class="err svelte-156lzfn"> </div>'),va=z('<div class="inputRow"><label for="p1" class="svelte-156lzfn">Contraseña</label> <div class="inputWrap svelte-156lzfn"><input id="p1" class="input svelte-156lzfn" placeholder="••••••••" autocomplete="new-password"/> <button type="button" class="toggle svelte-156lzfn"> </button></div></div> <div class="inputRow"><label for="p2" class="svelte-156lzfn">Confirmar contraseña</label> <input id="p2" class="input svelte-156lzfn" placeholder="••••••••" autocomplete="new-password"/></div> <!> <button class="btn svelte-156lzfn"> </button>',1),pa=z('<div class="page svelte-156lzfn"><section class="card svelte-156lzfn" role="form" aria-labelledby="reset-title"><div class="head svelte-156lzfn"><h1 id="reset-title" class="svelte-156lzfn">Nueva contraseña</h1> <span class="pill svelte-156lzfn">Paso 2 de 2</span></div> <div class="body svelte-156lzfn"><!></div></section></div>');function xa(j,D){Y(D,!1);const O=()=>la(ia,"$page",J),[J,W]=ra(),C=i();let n=i(""),f=i(""),p=i(!1),u=i(!1),c=i(""),N=i(!1);const q=e=>e.length>=8;async function F(){if(t(c,""),!q(a(n))){t(c,"Mínimo 8 caracteres.");return}if(a(n)!==a(f)){t(c,"Las contraseñas no coinciden.");return}t(u,!0);try{const e=await fetch(`${ta}/auth/password/reset`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({token:a(C),password:a(n)}),credentials:"include",mode:"cors"});if(!e.ok)throw new Error(await e.text()||"Error");t(N,!0)}catch(e){t(c,e.message||"No se pudo actualizar la contraseña.")}finally{t(u,!1)}}Z(()=>O(),()=>{t(C,O().params.token)}),aa(),sa();var h=pa(),P=s(h),S=l(s(P),2),G=s(S);{var H=e=>{var d=na(),v=l(I(d),2),m=s(v);r(v),A(()=>E(m,"href",`${oa}/login`)),g(e,d)},K=e=>{var d=va(),v=I(d),m=l(s(v),2),_=s(m);R(_);var w=l(_,2),Q=s(w,!0);r(w),r(m),r(v);var y=l(v,2),x=l(s(y),2);R(x),r(y);var B=l(y,2);{var U=o=>{var k=ca(),X=s(k,!0);r(k),A(()=>$(X,a(c))),g(o,k)};M(B,o=>{a(c)&&o(U)})}var b=l(B,2),V=s(b,!0);r(b),A(()=>{E(_,"type",a(p)?"text":"password"),$(Q,a(p)?"Ocultar":"Mostrar"),E(x,"type",a(p)?"text":"password"),b.disabled=a(u)||!a(n)||!a(f),$(V,a(u)?"Actualizando…":"Actualizar contraseña")}),T(_,()=>a(n),o=>t(n,o)),L("click",w,()=>t(p,!a(p))),T(x,()=>a(f),o=>t(f,o)),L("click",b,F),g(e,d)};M(G,e=>{a(N)?e(H):e(K,!1)})}r(S),r(P),r(h),g(j,h),ea(),W()}export{xa as component};
