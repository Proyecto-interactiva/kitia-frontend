import"../chunks/DsnmJJEf.js";import"../chunks/BFDTQnE2.js";import{o as Be,a as Ee}from"../chunks/D1BxDaDw.js";import{av as Le,aw as S,ax as Pe,ay as m,a as d,az as Ae,b as e,K as u,s as v,aB as t,aC as a,aA as r,aD as b,u as i,c as Ie,f as ie,aF as De}from"../chunks/SI9NORCZ.js";import{s as g,e as W}from"../chunks/vrbBCUDO.js";import{i as L}from"../chunks/Bk_PEv9-.js";import{e as G,i as H}from"../chunks/ANp3hlrG.js";import{A as le,s as Re,r as Ne,a as Oe}from"../chunks/BWIOaSNU.js";import{s as Se}from"../chunks/BPRpnUBQ.js";import{s as Te}from"../chunks/BQ16QJwW.js";import{i as Ve}from"../chunks/DM9A9UiJ.js";import{s as Fe,a as Je}from"../chunks/BjmRvjV3.js";import{p as Ke}from"../chunks/BNKL2WN4.js";import{b as Ue}from"../chunks/BEn3cLHe.js";var We=m('<div class="skeletonCard svelte-9jfjg4"><span class="skDot svelte-9jfjg4"></span> <div class="skLines svelte-9jfjg4"><span class="skLine svelte-9jfjg4"></span> <span class="skLine short svelte-9jfjg4"></span></div> <span class="skBadge svelte-9jfjg4"></span></div>'),Ge=m('<section class="loadingWrap svelte-9jfjg4" aria-busy="true" aria-live="polite"><div class="loader svelte-9jfjg4"><div class="pill svelte-9jfjg4"><svg viewBox="0 0 24 24" width="22" height="22" aria-hidden="true" class="svelte-9jfjg4"><path d="M20 6L9 17l-5-5" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svelte-9jfjg4"></path></svg> <span class="orbit svelte-9jfjg4"></span></div> <div class="progress svelte-9jfjg4" role="progressbar" aria-valuemin="0" aria-valuemax="100"><div class="bar svelte-9jfjg4"></div></div> <div class="tip svelte-9jfjg4"><strong class="svelte-9jfjg4"> </strong> </div></div> <div class="skeletonList svelte-9jfjg4"></div></section>'),He=m('<p class="error svelte-9jfjg4"> </p>'),Qe=m('<p style="margin:0; color:var(--muted); font-size:14px" class="svelte-9jfjg4"><strong class="svelte-9jfjg4">Etapa:</strong> </p>'),Xe=m('<p style="margin:0 0 6px; color:var(--muted)" class="svelte-9jfjg4"><strong class="svelte-9jfjg4">Descripción:</strong> </p>'),Ye=m('<p class="pilar-desc svelte-9jfjg4"> </p>'),Ze=m('<label><input class="check svelte-9jfjg4" type="checkbox"/> <span class="tick svelte-9jfjg4" aria-hidden="true"><svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true" class="svelte-9jfjg4"><path d="M20 6L9 17l-5-5" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svelte-9jfjg4"></path></svg></span> <span class="qtext svelte-9jfjg4"> </span> <span class="meta svelte-9jfjg4"><!> </span></label>'),qe=m('<section class="pilar svelte-9jfjg4"><h2 class="pilar-title svelte-9jfjg4"> </h2> <!> <div class="list svelte-9jfjg4"></div></section>'),ea=m(`<header class="heading svelte-9jfjg4"><h1 class="svelte-9jfjg4"></h1></header> <div class="card svelte-9jfjg4" style="max-width:980px; margin:0 auto 20px; padding:16px;"><h2 style="margin:0 0 6px" class="svelte-9jfjg4"> </h2> <!> <!></div> <hr class="svelte-9jfjg4"/> <h1 style="text-align:center; margin: 20px auto 10px; font-size: clamp(20px,4vw,32px); max-width:980px;" class="svelte-9jfjg4">Revisión de Pilares Éticos</h1> <p style="text-align:center; margin:0 auto 24px; color:
            var(--muted); font-size: clamp(14px,2vw,18px); max-width:980px;" class="svelte-9jfjg4">Para continuar con el  análisis y guiarte mejor en el cumplimiento ético, necesitamos que nos cuentes verazmente si tu trabajo cumple con los siguientes postulados:</p> <!> <div class="summary svelte-9jfjg4"> </div> <nav class="actions svelte-9jfjg4"><button class="back svelte-9jfjg4" type="button" aria-label="Volver"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="svelte-9jfjg4"><path d="M15 18l-6-6 6-6" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="svelte-9jfjg4"></path></svg></button> <button class="cta svelte-9jfjg4" type="button">Continuar</button></nav>`,1),aa=m('<section class="screen svelte-9jfjg4"><!></section>');function ua(ne,ce){Le(ce,!1);const Q=()=>Je(Ke,"$page",ve),[ve,pe]=Fe(),R=u();let p=u({nombre:"",descripcion:"",pilares:[]}),y=u([]),M=u(!0),T=u(""),P=u({comp:0,total:0}),X=u(0);Be(async()=>{try{const s=await fetch(`${le}/evaluaciones/${e(R)}/checklist`);if(!s.ok)throw new Error(await s.text());v(p,await s.json()),v(y,e(p).pilares??[])}catch(s){v(T,s.message)}finally{v(M,!1)}});const Y=["Verificando fuentes…","Midiendo impacto y riesgos…","Buscando sesgos…","Revisando transparencia y trazabilidad…","Organizando preguntas del pilar actual…"];let k=u(0),z=u(0),h=u(null);Ee(()=>{e(h)&&clearInterval(e(h))});function de(s,l,f){const _=e(y).find(n=>n.id===s);if(!_)return;const w=_.preguntas.find(n=>n.id===l);w&&(w.completada=f,fetch(`${le}/evaluaciones/${e(R)}/preguntas/${l}`,{method:"PUT",headers:{"content-type":"application/json"},body:JSON.stringify({completada:f,notas:w.notas??""})}).then(n=>{if(n.ok)v(y,[...e(y)]);else throw new Error("Error actualizando pregunta")}).catch(()=>{}))}function fe(){history.back()}function ge(){window.location.href=`${Ue}/evaluaciones/${e(R)}/resultados`}S(()=>Q(),()=>{v(R,Q().params.id)}),S(()=>e(y),()=>{const s=e(y).flatMap(l=>l.preguntas);v(P,{comp:s.filter(l=>l.completada).length,total:s.length}),v(X,s.reduce((l,f)=>l+(f.completada?f.puntos:0),0))}),S(()=>(e(M),e(h),e(k),e(z)),()=>{e(M)&&!e(h)&&(v(k,0),v(z,0),v(h,setInterval(()=>{v(k,Math.min(95,e(k)+Math.ceil(Math.random()*7))),v(z,(e(z)+1)%Y.length)},600)))}),S(()=>(e(M),e(h)),()=>{!e(M)&&e(h)&&(clearInterval(e(h)),v(h,null),v(k,100))}),Pe(),Ve();var V=aa(),je=t(V);{var ue=s=>{var l=Ge(),f=t(l),_=r(t(f),2),w=t(_);a(_);var n=r(_,2),j=t(n),$=t(j);a(j);var F=r(j);a(n),a(f);var B=r(f,2);G(B,4,()=>Array(3),H,(A,Z)=>{var N=We();d(A,N)}),a(B),a(l),b(()=>{Re(_,"aria-valuenow",e(k)),Te(w,`width:${e(k)}%`),g($,`${e(k)??""}%`),g(F,` · ${e(z),i(()=>Y[e(z)])??""}`)}),d(s,l)},me=s=>{var l=Ie(),f=ie(l);{var _=n=>{var j=He(),$=t(j,!0);a(j),b(()=>g($,e(T))),d(n,j)},w=n=>{var j=ea(),$=ie(j),F=t($);F.textContent="Evaluación ética inicial",a($);var B=r($,2),A=t(B),Z=t(A);a(A);var N=r(A,2);{var he=x=>{var o=Qe(),C=r(t(o));a(o),b(()=>g(C,` ${e(p),i(()=>e(p).etapa)??""}`)),d(x,o)};L(N,x=>{e(p),i(()=>e(p).etapa)&&x(he)})}var _e=r(N,2);{var xe=x=>{var o=Xe(),C=r(t(o));a(o),b(()=>g(C,` ${e(p),i(()=>e(p).descripcion)??""}`)),d(x,o)};L(_e,x=>{e(p),i(()=>e(p).descripcion)&&x(xe)})}a(B);var q=r(B,8);G(q,1,()=>e(y),H,(x,o)=>{var C=qe(),K=t(C),ye=t(K,!0);a(K);var te=r(K,2);{var we=I=>{var c=Ye(),E=t(c,!0);a(c),b(()=>g(E,(e(o),i(()=>e(o).descripcion)))),d(I,c)};L(te,I=>{e(o),i(()=>e(o).descripcion)&&I(we)})}var se=r(te,2);G(se,5,()=>(e(o),i(()=>e(o).preguntas)),H,(I,c)=>{var E=Ze(),O=t(E);Ne(O);var U=r(O,4),$e=t(U,!0);a(U);var re=r(U,2),oe=t(re);{var Ce=D=>{var ze=De("Crítica ·");d(D,ze)};L(oe,D=>{e(c),i(()=>e(c).critica)&&D(Ce)})}var Me=r(oe);a(re),a(E),b(()=>{Se(E,1,`q ${e(c),i(()=>e(c).completada?"done":"")??""}`,"svelte-9jfjg4"),Oe(O,(e(c),i(()=>e(c).completada))),g($e,(e(c),i(()=>e(c).texto))),g(Me,`${e(c),i(()=>e(c).puntos)??""}p`)}),W("change",O,D=>de(e(o).id,e(c).id,D.currentTarget.checked)),d(I,E)}),a(se),a(C),b(()=>g(ye,(e(o),i(()=>e(o).nombre)))),d(x,C)});var J=r(q,2),ke=t(J);a(J);var ee=r(J,2),ae=t(ee),be=r(ae,2);a(ee),b(()=>{g(Z,`Nombre: ${e(p),i(()=>e(p).nombre)??""}`),g(ke,`Progreso: ${e(P),i(()=>e(P).comp)??""}/${e(P),i(()=>e(P).total)??""} · Puntos: ${e(X)??""}`)}),W("click",ae,fe),W("click",be,ge),d(n,j)};L(f,n=>{e(T)?n(_):n(w,!1)},!0)}d(s,l)};L(je,s=>{e(M)?s(ue):s(me,!1)})}a(V),d(ne,V),Ae(),pe()}export{ua as component};
